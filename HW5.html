<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Hw5 - Project Prototype</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <link rel="stylesheet" href="hw5.css">
  </head>
  <body>
    <script>
      d3.csv("updated_runnning_log.csv", function(data) {
            // main header
            d3.select("body")
              .append("h1")
              .text("Running Data")

            // introductory paragraph
            d3.select("body")
              .append("p")
              .attr("id", "intro")
              .text("Our group consists of Christopher Major, a data science & analytics major, and Drew Burns, an information technology major and division one runner. Together, we decided that running data found on my smart watch might be an interesting place to compare and visualize data. The data available for this study includes running history recorded on my smart watch almost every day from 2016 to present . This including variables such as…… location, activity type, time, average/best pace, average heart rate/maximum heart rate, average stride length, calories burned, elevation gained/ lost, average and maximum cadence, distance, etc. In the running community a wide range of athletes use Garmin technologies to obtain information to further their knowledge of their body and their overall training. Our objective is to make visualizations and conclusions based off of my running data in the hope other people could benefit from our visualization as well. Anyone with a Garmin product can log into their account and export the data they have accumulated in the same formatted CSV file as mine. This makes our visualization compatible for various athletes worldwide. The story we hope to tell is how heart rate dictates your overall fitness level. This will be accomplished using charts to show data like distances run over time, the pace those runs were at, and the average heart rate. I expect our results to show that on average, running a similar pace in the beginning of your training will result in a higher heart rate than at the completion of your training. Other interesting things to visualize for users could be how your cadence and stride length are related, and how those would then relate to your pace. However, the relation between pace and heart rate is our main focus in the project. While making accurate conclusions based solely off my own personal data will be inaccurate due to a small sample size and other outside factors, I hope to make some general conclusions based off the data available to me through both my Garmin Vívoactive smartwatch and Garmin soft strap premium heart rate monitor through visualizations. Outlined below are some studies and data sets we will potentially be referencing for information about similar studies that relate to our topic. Attached is a draft of an old CSV file of my running data.");

            // table variables
            var columns = Object.keys(data[0]);
            var table = d3.select("body").append("table").attr("id", "running");
            var thead = table.append("thead");
            var tbody = table.append("tbody");

            // load dataset columns
            thead.append("tr").selectAll("th")
              .data(columns)
              .enter()
              .append("th")
              .text(function(d) { return d; });

            // load dataset rows
            var rows = tbody.selectAll("tr")
              .data(data)
              .enter()
              .append("tr");

            // load dataset values
            var cells = rows.selectAll("td")
              .data(function(row) {
                return d3.range(Object.keys(row).length).
                map(function(column, i) {
                  return row[columns[i]];
                });
              })
              .enter()
              .append("td")
              .text(function(d) { return d; });

            // chart variables
            var padding = 5;
            var w = 1377;
            var h = 500;

            // barchart headers
            d3.select("body")
              .append("h2")
              .attr("id", "bar-chart-header")
              .html("Calories");

            // barchart svg
            var svg = d3.select("body")
              .append("svg")
              .attr("class", "bar-chart")
              .attr("width", w)
              .attr("height", h);

            // barchart x-scale
            var xScaleBar = d3.scaleBand()
              .domain(d3.range(data.length))
              .rangeRound([0, w])
              .paddingInner(0.5);

            // calorie y-scale
            var yScaleCal = d3.scaleLinear()
              .domain([0, d3.max(data, function(d) { return parseFloat(d["Calories"]); })])
              .range([h, padding]);

            // max hr y-scale
            var yScaleMaxHR = d3.scaleLinear()
              .domain([0, d3.max(data, function(d) { return parseFloat(d["Max HR"]); })])
              .range([h, padding]);

            // avg hr y-scale
            var yScaleAvgHR = d3.scaleLinear()
              .domain([0, d3.max(data, function(d) { return parseFloat(d["Avg HR"]); })])
              .range([h, padding]);

<<<<<<< HEAD
            // calorie axis
=======
            var yScaleMaxCadence = d3.scaleLinear()
              .domain([0, d3.max(data, function(d) { return parseFloat(d["Max Cadence"]); })])
              .range([h, padding]);

>>>>>>> 47643bc4663f3b2318c8fba85a49d84bb2533c33
            var yAxisCal = d3.axisRight()
              .scale(yScaleCal)
              .ticks(10);

            // max hr axis
            var yAxisMaxHR = d3.axisRight()
              .scale(yScaleMaxHR)
              .ticks(10);

            // avg hr axis
            var yAxisAvgHR = d3.axisRight()
              .scale(yScaleAvgHR)
              .ticks(10);

            var yAxisMaxCadence = d3.axisRight()
              .scale(yScaleMaxCadence)
              .ticks(10);

            svg.selectAll("rect")
              .data(data)
              .enter()
              .append("rect")
              .attr("class", "calories")
              .attr("x", function(d, i) {
                return xScaleBar(i);
              })
              .attr("y", function(d) {
                return yScaleCal(d["Calories"]) - padding;
              })
              .attr("width", xScaleBar.bandwidth())
              .attr("height", function(d) {
                return h - yScaleCal(d["Calories"]);
              })
              .attr("fill", "crimson")

              // mouseover
              .on("mouseover", function() {
                d3.select(this)
                .attr("fill", "darkblue");
              })
              .on("mouseout", function(d) {
                d3.select(this)
                .attr("fill", "crimson");
               });

            // append calorie axis
            svg.append("g")
              .attr("class", "axis")
              .attr("transform", "translate(" + padding + "," + (padding * -1) + ")")
              .call(yAxisCal);

            // append footer
            d3.select("body")
              .append("p")
              .attr("id", "bar-chart-footer");

            // append calorie transition button
            d3.select("#bar-chart-footer")
              .append("button")
              .attr("class", "button")
              .on("click", function() {
                // update header
                d3.select("#bar-chart-header")
                  .html("Calories")
                  .transition();

                // update barchart
                svg.selectAll("rect")
                  .data(data)
                  .transition()
                  .duration(3000)
                  .attr("class", "calories")
                  .attr("x", function(d, i) {
                    return xScaleBar(i);
                  })
                  .attr("y", function(d) {
                    return yScaleCal(d["Calories"]) - padding;
                  })
                  .attr("width", xScaleBar.bandwidth())
                  .attr("height", function(d) {
                    return h - yScaleCal(d["Calories"]);
                  })
                  .attr("fill", "crimson");

                // update axis
                svg.select(".axis")
                  .transition()
                  .duration(3000)
                  .call(yAxisCal);
              })
              .html("Calories");

            // append Max HR transition button
            d3.select("#bar-chart-footer")
              .append("button")
              .attr("class", "button")
              .on("click", function() {
                // update header
                d3.select("#bar-chart-header")
                  .html("Max HR")
                  .transition();

                // update barchart
                svg.selectAll("rect")
                  .data(data)
                  .transition()
                  .duration(3000)
                  .attr("class", "max-hr")
                  .attr("x", function(d, i) {
                    return xScaleBar(i);
                  })
                  .attr("y", function(d) {
                    return yScaleMaxHR(d["Max HR"]) - padding;
                  })
                  .attr("width", xScaleBar.bandwidth())
                  .attr("height", function(d) {
                    return h - yScaleMaxHR(d["Max HR"]);
                  })
                  .attr("fill", "crimson");

                // update axis
                svg.select(".axis")
                  .transition()
                  .duration(3000)
                  .call(yAxisMaxHR);
              })
              .html("Max HR");

              // append Avg HR transition button
              d3.select("#bar-chart-footer")
              .append("button")
              .attr("class", "button")
              .on("click", function() {
                // update header
                d3.select("#bar-chart-header")
                  .html("Avg HR")
                  .transition();

                // update barchart
                svg.selectAll("rect")
                  .data(data)
                  .transition()
                  .duration(3000)
                  .attr("class", "Avg-HR")
                  .attr("x", function(d, i) {
                    return xScaleBar(i);
                  })
                  .attr("y", function(d) {
                    return yScaleAvgHR(d["Avg HR"]) - padding;
                  })
                  .attr("width", xScaleBar.bandwidth())
                  .attr("height", function(d) {
                    return h - yScaleAvgHR(d["Avg HR"]);
                  })
                  .attr("fill", "crimson");

                // update axis
                svg.select(".axis")
                  .transition()
                  .duration(3000)
                  .call(yAxisAvgHR);
              })
              .html("Avg HR");

              //update to Max Cadence
              d3.select("#bar-chart-footer")
              .append("button")
              .attr("class", "button")
              .on("click", function() {
                d3.select("#bar-chart-header")
                  .html("Max Cadence")
                  .transition();

                //update barchart
                svg.selectAll("rect")
                  .data(data)
                  .transition()
                  .duration(3000)
                  .attr("class", "Max-Cadence")
                  .attr("x", function(d, i) {
                    return xScaleBar(i);
                  })
                  .attr("y", function(d) {
                    return yScaleMaxCadence(d["Max Cadence"]) - padding;
                  })
                  .attr("width", xScaleBar.bandwidth())
                  .attr("height", function(d) {
                    return h - yScaleMaxCadence(d["Max Cadence"]);
                  })
                  .attr("fill", "crimson");

                svg.select(".axis")
                  .transition()
                  .duration(3000)
                  .call(yAxisMaxCadence);
              })
              .html("Max Cadence");

            /*svg.selectAll("text")
              .data(data)
              .enter()
              .append("text")
              .text(function(d) {
                return d["Calories"];
              })
              .attr("text-anchor", "middle")
              .attr("x", function(d, i) {
                return xScaleBar(i);
              })
              .attr("y", function(d) {
                return yScaleCal(d["Calories"]) - 10;
              })
              .attr("font-family", "verdana")
              .attr("font-size", "12px")
              .attr("fill", "white");*/

            d3.select("body")
              .append("h2")
              .html("Scatter Plots")

            var svg2 = d3.select("body")
              .append("svg")
              .attr("width", w)
              .attr("height", h);

            var xScalePlot = d3.scaleLinear()
              .domain([0, d3.max(data, function(d) { return (d["Distance"]); })])
              .range([padding, w - padding]);

            var yScalePlot = d3.scaleLinear()
              .domain([0, d3.max(data, function(d) { return d["Calories"]; })])
              .range([h - padding, padding]);

            var xAxisPlot = d3.axisTop()
              .scale(xScalePlot)
              .ticks(10);

            var yAxisPlot = d3.axisRight()
              .scale(yScalePlot)
              .ticks(10);

            svg2.selectAll("circle")
              .data(data)
              .enter()
              .append("circle")
              .attr("cx", function(d) {
                return xScalePlot(d["Distance"] * 10);
              })
              .attr("cy", function(d) {
                return yScalePlot(d["Calories"]);
              })
              .attr("r", "2")
              .attr("fill", "crimson");

            /*svg2.selectAll("text")
              .data(data)
              .enter()
              .append("text")
              .text(function(d) {
                return d["Distance"] + "," + d["Calories"];
              })
              .attr("x", function(d) {
                return xScalePlot(d["Distance"]);
              })
              .attr("y", function(d) {
                return yScalePlot(d["Calories"]);
              })
              .attr("font-family", "verdana")
              .attr("font-size", "12px")
              .attr("fill", "black");*/

            svg2.append("g")
              .attr("class", "axis")
              .attr("transform", "translate(0," + (h - padding) + ")")
              .call(xAxisPlot);

            svg2.append("g")
              .attr("class", "axis")
              .attr("transform", "translate(" + padding + ",0)")
              .call(yAxisPlot);

            d3.select("body")
              .append("p")
              .attr("id", "footer")
              .html("DATA 300L - 111 <br> Andrew Burns, Christopher Major <br> 04/25/2018 <br> <a href='updated_runnning_log.csv' target='_blank'> Dataset </a>");
          });
    </script>
  </body>
</html>
